#  Reading Excel spreadsheets
<p><a href="" id="index-_002exls-1"></a> <a href="" id="index-_002exlsx"></a></p>
<p>The most common R data import/export question seems to be ‘how do I read an Excel spreadsheet’. This chapter collects together advice and options given earlier. Note that most of the advice is for pre-Excel 2007 spreadsheets and not the later .xlsx format.</p>
<p><a href="" id="index-read_002ecsv-1"></a> <a href="" id="index-read_002edelim-1"></a> <a href="" id="index-read_002eDIF-1"></a> <a href="" id="index-read_002etable-2"></a> <a href="" id="index-readClipboard"></a></p>
<p>The first piece of advice is to avoid doing so if possible! If you have access to Excel, export the data you want from Excel in tab-delimited or comma-separated form, and use <code class="calibre2">read.delim</code> or <code class="calibre2">read.csv</code> to import it into R. (You may need to use <code class="calibre2">read.delim2</code> or <code class="calibre2">read.csv2</code> in a locale that uses comma as the decimal point.) Exporting a DIF file and reading it using <code class="calibre2">read.DIF</code> is another possibility.</p>
<p>If you do not have Excel, many other programs are able to read such spreadsheets and export in a text format on both Windows and Unix, for example Gnumeric (<a href="http://www.gnome.org/projects/gnumeric/" class="uri">http://www.gnome.org/projects/gnumeric/</a>) and OpenOffice (<a href="https://www.openoffice.org" class="uri">https://www.openoffice.org</a>). You can also cut-and-paste between the display of a spreadsheet in such a program and R: <code class="calibre2">read.table</code> will read from the R console or, under Windows, from the clipboard (via <code class="calibre2">file = &quot;clipboard&quot;</code> or <code class="calibre2">readClipboard</code>). The <code class="calibre2">read.DIF</code> function can also read from the clipboard.</p>
<p>Note that an Excel .xls file is not just a spreadsheet: such files can contain many sheets, and the sheets can contain formulae, macros and so on. Not all readers can read other than the first sheet, and may be confused by other contents of the file.</p>
<p><a href="" id="index-odbcConnectExcel-1"></a> <a href="" id="index-odbcConnectExcel2007"></a></p>
<p>Windows users (of 32-bit R) can use <code class="calibre2">odbcConnectExcel</code> in package <a href="https://CRAN.R-project.org/package=RODBC"><strong>RODBC</strong></a>. This can select rows and columns from any of the sheets in an Excel spreadsheet file (at least from Excel 97–2003, depending on your ODBC drivers: by calling <code class="calibre2">odbcConnect</code> directly versions back to Excel 3.0 can be read). The version <code class="calibre2">odbcConnectExcel2007</code> will read the Excel 2007 formats as well as earlier ones (provided the drivers are installed, including with 64-bit Windows R: see <a href="007-R-data.html#RODBC">RODBC</a>). macOS users can also use <a href="https://CRAN.R-project.org/package=RODBC"><strong>RODBC</strong></a> if they have a suitable driver (e.g. that from Actual Technologies).</p>
<p><a href="" id="index-read_002exls"></a></p>
<p><code class="calibre2">Perl</code> users have contributed a module <code class="calibre2">OLE::SpreadSheet::ParseExcel</code> and a program <code class="calibre2">xls2csv.pl</code> to convert Excel 95–2003 spreadsheets to CSV files. Package <a href="https://CRAN.R-project.org/package=gdata"><strong>gdata</strong></a> provides a basic wrapper in its <code class="calibre2">read.xls</code> function. With suitable <code class="calibre2">Perl</code> modules installed this function can also read Excel 2007 spreadsheets.</p>
<p><a href="" id="index-dataframes2xls"></a> <a href="" id="index-WriteXLS"></a></p>
<p>Packages <a href="https://CRAN.R-project.org/package=dataframes2xls"><strong>dataframes2xls</strong></a> and <a href="https://CRAN.R-project.org/package=WriteXLS"><strong>WriteXLS</strong></a> each contain a function to <em>write</em> one or more data frames to an .xls file, using Python and Perl respectively.</p>
<p><a href="" id="index-xlsx"></a></p>
<p>Packages <a href="https://CRAN.R-project.org/package=xlsx"><strong>xlsx</strong></a> can read and and manipulate Excel 2007 and later spreadsheets: it requires Java.</p>
<p><a href="" id="index-XLConnect"></a></p>
<p>Package <a href="https://CRAN.R-project.org/package=XLConnect"><strong>XLConnect</strong></a> can read, write and manipulate both Excel 97–2003 and Excel 2007/10 spreadsheets, using Java.</p>
<p><a href="" id="index-readxl"></a></p>
<p>Package <a href="https://CRAN.R-project.org/package=readxl"><strong>readxl</strong></a> can read both Excel 97–2003 and Excel 2007/10 spreadsheets, using an included C library.</p>
<hr />
<p><a href="" id="References"></a> <a href="" id="References-1"></a></p>
